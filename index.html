<!DOCTYPE html>
<html>
<head>
<title>H_YBR__I_D___D_E_CL___I_N_ER__S</title>

<script
  src="https://code.jquery.com/jquery-3.0.0.min.js"   
  integrity="sha256-JmvOoLtYsmqlsWxa7mDSLMwa6dZ9rrIdtrrVYRnDRH0="
  crossorigin="anonymous"></script>

<link rel="stylesheet" href='https://fonts.googleapis.com/css?family=Montserrat' type='text/css'>
<link rel="stylesheet" type="text/css" href="res/style.css">

</head>
<body>

<div id="container">
  <svg id="title" class="ui reposition-bottom">
    <defs>
      <mask id="mask" x="0" y="0" width="600" height="120">
        <rect x="0" y="0" width="600" height="80" fill="#fff"></rect>
        <path d="M 600 0 L 622 80 H 600 Z" fill="#fff" stroke="#fff"></path>
        <text text-anchor="left" x="26" y="80" dy="1">HYbRID DEc LllNERs</text>
        <text text-anchor="left" x="26" y="80" dy="1">HYBRID DECLINERS</text>
      </mask>
    </defs>
    <rect x="0" y="0" width="630" height="120" mask="url(#mask)" fill-opacity="1.0" fill="#444"></rect>    
  </svg>
  <div class="ui toolbar reposition-bottom reposition-right">
    <div class="toolbar-row">
      <button class="speed" id="slow">65bpm</button>
      <button class="speed" id="fast" style="display:none">104bpm</button>
      <button class="speed" id="faster">146bpm</button>
      <button id="show-about">about</reload>
      <button id="reload">reload</reload>
    </div>
  </div>
  <div id="about" class="ui">
    <p>HYBRID DECLINERS performs live, improvised, retro-futuristic modular techno. A project by musician/producer <a href="https://twitter.com/infrasonick">Nick Donaldson</a> (<a href="https://soundcloud.com/kip-schwinger">Kip Schwinger</a>) and sound designer/visual artist <a href="http://dewb.org">Michael Dewberry</a> (<a href="http://videobleep.tv/">Video Bleep</a>, <a href="http://pmrp.org/">Post-Meridian Radio Players</a>).</p>

    <p><a href="https://soundcloud.com/hybrid-decliners">soundcloud.com/hybrid-decliners</a></p>

    <p>background videos sourced and mixed live in your browser from <a href="http://vine.co">Vine</a> channels <a href="https://vine.co/channels/weird">"Weird"</a> and <a href="https://vine.co/channels/dance">"Dance"</a>
  </div>
</div>

<script src="js/utils.js"></script>
<script src="js/audio.js"></script>
<script src="js/video.js"></script>

<script>

  window.addEventListener('load', function(e) {

    reposition();

    $("#title").fadeIn(600);
    $(".toolbar").fadeIn(1100);

    getVineVideoUrls(
      [
        "https://crossorigin.me/https://api.vineapp.com/timelines/channels/vanity/weird",
        "https://crossorigin.me/https://api.vineapp.com/timelines/channels/vanity/dance",        
        //"https://crossorigin.me/https://vine.co/api/posts/search/politics",
        //"https://crossorigin.me/https://api.vineapp.com/timelines/users/907021576984211456", // Dewb
        //"https://crossorigin.me/https://api.vineapp.com/timelines/users/1071465578646110208", // POLITICO
        //"https://crossorigin.me/https://api.vineapp.com/timelines/users/1182450900061589504", // C-SPAN
        //"https://crossorigin.me/https://api.vineapp.com/timelines/users/1038266807917965312", // CNN Politics
      ], 
      {
        numPerChannel: 2,
      },
      function (urls) {
         var beatFn = setupRandomPlayVideos(urls, { 
          interval: 610, 
          audio: true, 
          processAudio: true, 
          resetToStartChance: 0.7,
          delayTime: 300
        });

        window.beatInterval = 580;
        window.lastBeat = 0;

        var frameFn = function(time) {
          if (time - window.lastBeat > window.beatInterval) {
            beatFn();
            window.lastBeat = time;
          }
          window.requestAnimationFrame(frameFn);
        }

        window.requestAnimationFrame(frameFn);
      }
    );
  });

  window.addEventListener('resize', function(e) {
    reposition();
  });

  function reposition() {
    var h = $(window).height(), w = $(window).width();
    $('.reposition-bottom').css({'top' : (h - 180) + 'px'});
    $('.reposition-right').css({'left' : (w - 160) + 'px'});
  }

  $("#show-about").click(function() {
    if ($('#about').css('display') == 'none') {
      $('#about').fadeIn();
      $("#show-about").text("hide");
    } else {
      $(".ui").fadeOut();
    }
  });

  $("#reload").click(function() {
    window.location.reload();
  });

  $("#fast").click(function() {
    $(".speed").show();
    $("#fast").hide();
    window.beatInterval = 580;
  });

  $("#slow").click(function() {
    $(".speed").show();
    $("#slow").hide();
    window.beatInterval = 920;
  });

  $("#faster").click(function() {
    $(".speed").show();
    $("#faster").hide();
    window.beatInterval = 410;
  });


</script>

</body>
</html>